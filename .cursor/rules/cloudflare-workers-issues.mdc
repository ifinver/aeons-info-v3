---
description: Cloudflare Workers å¼€å‘ä¸­çš„å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
---

# Cloudflare Workers å¼€å‘é—®é¢˜è§£å†³æŒ‡å—

## bcryptjs æ¨¡å—è§£æé”™è¯¯

### é—®é¢˜æè¿°
```
X [ERROR] Could not resolve "bcryptjs"
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨ Web Crypto APIï¼ˆæ¨èï¼‰
Cloudflare Workers åŸç”Ÿæ”¯æŒ Web Crypto APIï¼Œæ€§èƒ½æ›´å¥½ï¼š

```javascript
// æ›¿æ¢ bcryptjs çš„å“ˆå¸Œå‡½æ•°
async function hashPassword(password) {
  const encoder = new TextEncoder();
  const data = encoder.encode(password + 'salt'); // æ·»åŠ ç›å€¼
  const hashBuffer = await crypto.subtle.digest('SHA-256', data);
  return Array.from(new Uint8Array(hashBuffer))
    .map(b => b.toString(16).padStart(2, '0'))
    .join('');
}
```

#### æ–¹æ¡ˆ2ï¼šé…ç½®å¤–éƒ¨æ¨¡å—
åœ¨ `wrangler.toml` ä¸­é…ç½®ï¼š

```toml
[build]
command = "npm run build"

[[build.upload.rules]]
type = "ESModule"
globs = ["**/*.js", "**/*.mjs"]

# æ ‡è®° bcryptjs ä¸ºå¤–éƒ¨æ¨¡å—
[build.upload]
format = "modules"
```

#### æ–¹æ¡ˆ3ï¼šä½¿ç”¨å…¼å®¹çš„æ›¿ä»£åº“
```bash
npm uninstall bcryptjs
npm install @noble/hashes
```

ç„¶åæ›´æ–°å¯¼å…¥ï¼š
```javascript
import { sha256 } from '@noble/hashes/sha256';
```

## KV å‘½åç©ºé—´é…ç½®

### ç¡®ä¿æ‰€æœ‰ KV ç»‘å®šæ­£ç¡®é…ç½®
åœ¨ `wrangler.toml` ä¸­ï¼š

```toml
[[kv_namespaces]]
binding = "aeons_info_config"
id = "your-config-namespace-id"

[[kv_namespaces]]
binding = "aeons_info_practice_time"
id = "your-practice-time-namespace-id"

[[kv_namespaces]]
binding = "aeons_info_practice_logs"
id = "your-practice-logs-namespace-id"

[[kv_namespaces]]
binding = "aeons_info_users"
id = "your-users-namespace-id"

[[kv_namespaces]]
binding = "aeons_info_auth_tokens"
id = "your-auth-tokens-namespace-id"
```

### åˆ›å»ºæ–°çš„ KV å‘½åç©ºé—´
```bash
powershell -Command "Write-Host 'Creating KV namespace...'; Start-Sleep -Milliseconds 300; wrangler kv:namespace create 'aeons_info_practice_logs'; Write-Host 'KV namespace created'; Start-Sleep -Milliseconds 300"
```

## å¸¸è§éƒ¨ç½²é—®é¢˜

### ç±»å‹å®šä¹‰è¿‡æœŸ
```bash
powershell -Command "Write-Host 'Updating types...'; Start-Sleep -Milliseconds 300; wrangler types; Write-Host 'Types updated'; Start-Sleep -Milliseconds 300"
```

### æ¸…ç†å’Œé‡æ–°æ„å»º
```bash
powershell -Command "Write-Host 'Cleaning and rebuilding...'; Start-Sleep -Milliseconds 300; npm run clean; npm run build; Write-Host 'Rebuild completed'; Start-Sleep -Milliseconds 300"
```

### æ£€æŸ¥ Worker ç»‘å®š
```bash
powershell -Command "Write-Host 'Checking bindings...'; Start-Sleep -Milliseconds 300; wrangler dev --compatibility-date 2023-05-18; Write-Host 'Dev server started'; Start-Sleep -Milliseconds 300"
```

## è°ƒè¯•æŠ€å·§

### æœ¬åœ°å¼€å‘æ—¥å¿—
åœ¨ä»£ç ä¸­æ·»åŠ è¯¦ç»†æ—¥å¿—ï¼š
```javascript
console.log('ğŸ” Debug info:', { userId, timestamp: new Date().toISOString() });
```

### æ£€æŸ¥ç¯å¢ƒå˜é‡
```javascript
export default {
  async fetch(request, env, ctx) {
    console.log('ğŸ“Š Available bindings:', Object.keys(env));
    // ... å…¶ä»–ä»£ç 
  }
}
```